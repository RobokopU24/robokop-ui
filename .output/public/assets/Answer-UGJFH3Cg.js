import{j as o,r as h,e as Br,g as Vr,R as st,u as _r}from"./main-Bxfe4Qal.js";import{S as qr,n as Ge,D as Ur,a as ne,l as fr,b as gr,i as hr,e as mr,f as xr,g as se,d as br,j as yr,u as Wr,c as kt,k as Yr,o as Hr,p as Jr,t as Bt,m as Gr}from"./trapi-BJVMUwLk.js";import{B as gt,A as fe}from"./biolink-CvyEhlA2.js";import{m as vr,c as Qr,q as ut,s as ge,b as Xr,P as Kr}from"./queryGraph-B-h_kUel.js";import{c as xe,d as wr,u as Zr,b as St,B as en,C as tn}from"./CircularProgress-B8CBKe07.js";import{d as ze,g as Oe,e as Pe,h as ie,f as G,i as H,j as Ae,w as kr,m as le,l as dt,k as De,o as Sr,x as Ie,y as Vt,z as _t,A as jr}from"./createSimplePaletteValueFilter-BgnxeUzB.js";import{u as Cr,d as rn,b as me,L as at}from"./listItemTextClasses-BH3kCDiK.js";import{u as Se,T as nn,g as on,a as qt,r as sn,o as it,e as jt,I as lt}from"./IconButton-D-WOROUy.js";import{d as an,i as ct}from"./isHostComponent-D3YBfmz0.js";import{o as Rr,M as ln}from"./Modal-CENjY7I_.js";import{P as Te}from"./Paper-BphQmbS1.js";import{g as cn,T as un}from"./Toolbar-phJB3H_S.js";import{L as Ee,a as je}from"./ListItemText-BgG2IG-P.js";import{B as Fe}from"./Box-CViFGFuH.js";import{u as dn,L as pn,C as fn}from"./Loading-0cuKiJyU.js";import{T as zt,a as Pr,b as ce,d as Z,e as Ot,u as gn,f as Ct,h as hn,i as mn,j as xn,k as bn,g as yn}from"./index-jKozFsgT.js";import{L as Ut}from"./ListItem-hRsCqYjX.js";import{i as Wt}from"./isFocusVisible-B8k4qzLc.js";import{u as vn}from"./AlertProvider-CS83QDva.js";const wn=xe(o.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),kn=xe(o.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),Sn=xe(o.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function jn(e){return Oe("MuiCheckbox",e)}const Rt=ze("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Cn=e=>{const{classes:t,indeterminate:r,color:n,size:s}=e,c={root:["root",r&&"indeterminate",`color${H(n)}`,`size${H(s)}`]},i=Ae(c,jn,t);return{...t,...i}},Rn=G(qr,{shouldForwardProp:e=>kr(e)||e==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.indeterminate&&t.indeterminate,t[`size${H(r.size)}`],r.color!=="default"&&t[`color${H(r.color)}`]]}})(le(({theme:e})=>({color:(e.vars||e).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:dt(e.palette.action.active,e.palette.action.hoverOpacity)}}},...Object.entries(e.palette).filter(De()).map(([t])=>({props:{color:t,disableRipple:!1},style:{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:dt(e.palette[t].main,e.palette.action.hoverOpacity)}}})),...Object.entries(e.palette).filter(De()).map(([t])=>({props:{color:t},style:{[`&.${Rt.checked}, &.${Rt.indeterminate}`]:{color:(e.vars||e).palette[t].main},[`&.${Rt.disabled}`]:{color:(e.vars||e).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),Pn=o.jsx(kn,{}),An=o.jsx(wn,{}),Tn=o.jsx(Sn,{}),$n=h.forwardRef(function(t,r){const n=Pe({props:t,name:"MuiCheckbox"}),{checkedIcon:s=Pn,color:c="primary",icon:i=An,indeterminate:a=!1,indeterminateIcon:l=Tn,inputProps:u,size:x="medium",disableRipple:T=!1,className:d,slots:f={},slotProps:M={},...A}=n,L=a?l:i,O=a?l:s,k={...n,disableRipple:T,color:c,indeterminate:a,size:x},y=Cn(k),b=M.input??u,[v,$]=Se("root",{ref:r,elementType:Rn,className:ie(y.root,d),shouldForwardComponentProp:!0,externalForwardedProps:{slots:f,slotProps:M,...A},ownerState:k,additionalProps:{type:"checkbox",icon:h.cloneElement(L,{fontSize:L.props.fontSize??x}),checkedIcon:h.cloneElement(O,{fontSize:O.props.fontSize??x}),disableRipple:T,slots:f,slotProps:{input:vr(typeof b=="function"?b(k):b,{"data-indeterminate":a})}}});return o.jsx(v,{...$,classes:y})});function Nn(e,t,r){const n=t.getBoundingClientRect(),s=r&&r.getBoundingClientRect(),c=Rr(t);let i;if(t.fakeTransform)i=t.fakeTransform;else{const u=c.getComputedStyle(t);i=u.getPropertyValue("-webkit-transform")||u.getPropertyValue("transform")}let a=0,l=0;if(i&&i!=="none"&&typeof i=="string"){const u=i.split("(")[1].split(")")[0].split(",");a=parseInt(u[4],10),l=parseInt(u[5],10)}return e==="left"?s?`translateX(${s.right+a-n.left}px)`:`translateX(${c.innerWidth+a-n.left}px)`:e==="right"?s?`translateX(-${n.right-s.left-a}px)`:`translateX(-${n.left+n.width-a}px)`:e==="up"?s?`translateY(${s.bottom+l-n.top}px)`:`translateY(${c.innerHeight+l-n.top}px)`:s?`translateY(-${n.top-s.top+n.height-l}px)`:`translateY(-${n.top+n.height-l}px)`}function In(e){return typeof e=="function"?e():e}function Qe(e,t,r){const n=In(r),s=Nn(e,t,n);s&&(t.style.webkitTransform=s,t.style.transform=s)}const Mn=h.forwardRef(function(t,r){const n=Sr(),s={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},c={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:i,appear:a=!0,children:l,container:u,direction:x="down",easing:T=s,in:d,onEnter:f,onEntered:M,onEntering:A,onExit:L,onExited:O,onExiting:k,style:y,timeout:b=c,TransitionComponent:v=nn,...$}=t,D=h.useRef(null),_=wr(on(l),D,r),g=S=>m=>{S&&(m===void 0?S(D.current):S(D.current,m))},R=g((S,m)=>{Qe(x,S,u),sn(S),f&&f(S,m)}),q=g((S,m)=>{const E=qt({timeout:b,style:y,easing:T},{mode:"enter"});S.style.webkitTransition=n.transitions.create("-webkit-transform",{...E}),S.style.transition=n.transitions.create("transform",{...E}),S.style.webkitTransform="none",S.style.transform="none",A&&A(S,m)}),V=g(M),P=g(k),j=g(S=>{const m=qt({timeout:b,style:y,easing:T},{mode:"exit"});S.style.webkitTransition=n.transitions.create("-webkit-transform",m),S.style.transition=n.transitions.create("transform",m),Qe(x,S,u),L&&L(S)}),W=g(S=>{S.style.webkitTransition="",S.style.transition="",O&&O(S)}),F=S=>{i&&i(D.current,S)},z=h.useCallback(()=>{D.current&&Qe(x,D.current,u)},[x,u]);return h.useEffect(()=>{if(d||x==="down"||x==="right")return;const S=an(()=>{D.current&&Qe(x,D.current,u)}),m=Rr(D.current);return m.addEventListener("resize",S),()=>{S.clear(),m.removeEventListener("resize",S)}},[x,d,u]),h.useEffect(()=>{d||z()},[d,z]),o.jsx(v,{nodeRef:D,onEnter:R,onEntered:V,onEntering:q,onExit:j,onExited:W,onExiting:P,addEndListener:F,appear:a,in:d,timeout:b,...$,children:(S,{ownerState:m,...E})=>h.cloneElement(l,{ref:_,style:{visibility:S==="exited"&&!d?"hidden":void 0,...y,...l.props.style},...E})})});function Ln(e){return Oe("MuiDrawer",e)}ze("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const Ar=(e,t)=>{const{ownerState:r}=e;return[t.root,(r.variant==="permanent"||r.variant==="persistent")&&t.docked,t.modal]},En=e=>{const{classes:t,anchor:r,variant:n}=e,s={root:["root",`anchor${H(r)}`],docked:[(n==="permanent"||n==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${H(r)}`,n!=="temporary"&&`paperAnchorDocked${H(r)}`]};return Ae(s,Ln,t)},Dn=G(ln,{name:"MuiDrawer",slot:"Root",overridesResolver:Ar})(le(({theme:e})=>({zIndex:(e.vars||e).zIndex.drawer}))),Fn=G("div",{shouldForwardProp:kr,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:Ar})({flex:"0 0 auto"}),zn=G(Te,{name:"MuiDrawer",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.paper,t[`paperAnchor${H(r.anchor)}`],r.variant!=="temporary"&&t[`paperAnchorDocked${H(r.anchor)}`]]}})(le(({theme:e})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(e.vars||e).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:t})=>t.anchor==="left"&&t.variant!=="temporary",style:{borderRight:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:t})=>t.anchor==="top"&&t.variant!=="temporary",style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:t})=>t.anchor==="right"&&t.variant!=="temporary",style:{borderLeft:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:t})=>t.anchor==="bottom"&&t.variant!=="temporary",style:{borderTop:`1px solid ${(e.vars||e).palette.divider}`}}]}))),Tr={left:"right",right:"left",top:"down",bottom:"up"};function On(e){return["left","right"].includes(e)}function Bn({direction:e},t){return e==="rtl"&&On(t)?Tr[t]:t}const Vn=h.forwardRef(function(t,r){const n=Pe({props:t,name:"MuiDrawer"}),s=Sr(),c=Cr(),i={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{anchor:a="left",BackdropProps:l,children:u,className:x,elevation:T=16,hideBackdrop:d=!1,ModalProps:{BackdropProps:f,...M}={},onClose:A,open:L=!1,PaperProps:O={},SlideProps:k,TransitionComponent:y,transitionDuration:b=i,variant:v="temporary",slots:$={},slotProps:D={},..._}=n,g=h.useRef(!1);h.useEffect(()=>{g.current=!0},[]);const R=Bn({direction:c?"rtl":"ltr"},a),V={...n,anchor:a,elevation:T,open:L,variant:v,..._},P=En(V),j={slots:{transition:y,...$},slotProps:{paper:O,transition:k,...D,backdrop:vr(D.backdrop||{...l,...f},{transitionDuration:b})}},[W,F]=Se("root",{ref:r,elementType:Dn,className:ie(P.root,P.modal,x),shouldForwardComponentProp:!0,ownerState:V,externalForwardedProps:{...j,..._,...M},additionalProps:{open:L,onClose:A,hideBackdrop:d,slots:{backdrop:j.slots.backdrop},slotProps:{backdrop:j.slotProps.backdrop}}}),[z,S]=Se("paper",{elementType:zn,shouldForwardComponentProp:!0,className:ie(P.paper,O.className),ownerState:V,externalForwardedProps:j,additionalProps:{elevation:v==="temporary"?T:0,square:!0}}),[m,E]=Se("docked",{elementType:Fn,ref:r,className:ie(P.root,P.docked,x),ownerState:V,externalForwardedProps:j,additionalProps:_}),[C,X]=Se("transition",{elementType:Mn,ownerState:V,externalForwardedProps:j,additionalProps:{in:L,direction:Tr[R],timeout:b,appear:g.current}}),ue=o.jsx(z,{...S,children:u});if(v==="permanent")return o.jsx(m,{...E,children:ue});const he=o.jsx(C,{...X,children:ue});return v==="persistent"?o.jsx(m,{...E,children:he}):o.jsx(W,{...F,children:he})}),_n=e=>{const{alignItems:t,classes:r}=e;return Ae({root:["root",t==="flex-start"&&"alignItemsFlexStart"]},cn,r)},qn=G("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.alignItems==="flex-start"&&t.alignItemsFlexStart]}})(le(({theme:e})=>({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),Xe=h.forwardRef(function(t,r){const n=Pe({props:t,name:"MuiListItemIcon"}),{className:s,...c}=n,i=h.useContext(rn),a={...n,alignItems:i.alignItems},l=_n(a);return o.jsx(qn,{className:ie(l.root,s),ownerState:a,ref:r,...c})}),Un={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function Wn(e,t,r=(n,s)=>n===s){return e.length===t.length&&e.every((n,s)=>r(n,t[s]))}const Yn=2;function Re(e,t,r,n,s){return r===1?Math.min(e+t,s):Math.max(e-t,n)}function $r(e,t){return e-t}function Yt(e,t){const{index:r}=e.reduce((n,s,c)=>{const i=Math.abs(t-s);return n===null||i<n.distance||i===n.distance?{distance:i,index:c}:n},null)??{};return r}function Ke(e,t){if(t.current!==void 0&&e.changedTouches){const r=e;for(let n=0;n<r.changedTouches.length;n+=1){const s=r.changedTouches[n];if(s.identifier===t.current)return{x:s.clientX,y:s.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function pt(e,t,r){return(e-t)*100/(r-t)}function Hn(e,t,r){return(r-t)*e+t}function Jn(e){if(Math.abs(e)<1){const r=e.toExponential().split("e-"),n=r[0].split(".")[1];return(n?n.length:0)+parseInt(r[1],10)}const t=e.toString().split(".")[1];return t?t.length:0}function Gn(e,t,r){const n=Math.round((e-r)/t)*t+r;return Number(n.toFixed(Jn(t)))}function Ht({values:e,newValue:t,index:r}){const n=e.slice();return n[r]=t,n.sort($r)}function Ze({sliderRef:e,activeIndex:t,setActive:r}){var s,c,i;const n=it(e.current);(!((s=e.current)!=null&&s.contains(n.activeElement))||Number((c=n==null?void 0:n.activeElement)==null?void 0:c.getAttribute("data-index"))!==t)&&((i=e.current)==null||i.querySelector(`[type="range"][data-index="${t}"]`).focus()),r&&r(t)}function et(e,t){return typeof e=="number"&&typeof t=="number"?e===t:typeof e=="object"&&typeof t=="object"?Wn(e,t):!1}const Qn={horizontal:{offset:e=>({left:`${e}%`}),leap:e=>({width:`${e}%`})},"horizontal-reverse":{offset:e=>({right:`${e}%`}),leap:e=>({width:`${e}%`})},vertical:{offset:e=>({bottom:`${e}%`}),leap:e=>({height:`${e}%`})}},Xn=e=>e;let tt;function Jt(){return tt===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?tt=CSS.supports("touch-action","none"):tt=!0),tt}function Kn(e){const{"aria-labelledby":t,defaultValue:r,disabled:n=!1,disableSwap:s=!1,isRtl:c=!1,marks:i=!1,max:a=100,min:l=0,name:u,onChange:x,onChangeCommitted:T,orientation:d="horizontal",rootRef:f,scale:M=Xn,step:A=1,shiftStep:L=10,tabIndex:O,value:k}=e,y=h.useRef(void 0),[b,v]=h.useState(-1),[$,D]=h.useState(-1),[_,g]=h.useState(!1),R=h.useRef(0),q=h.useRef(null),[V,P]=dn({controlled:k,default:r??l,name:"Slider"}),j=x&&((p,w,N)=>{const B=p.nativeEvent||p,U=new B.constructor(B.type,B);Object.defineProperty(U,"target",{writable:!0,value:{value:w,name:u}}),q.current=w,x(U,w,N)}),W=Array.isArray(V);let F=W?V.slice().sort($r):[V];F=F.map(p=>p==null?l:Ie(p,l,a));const z=i===!0&&A!==null?[...Array(Math.floor((a-l)/A)+1)].map((p,w)=>({value:l+A*w})):i||[],S=z.map(p=>p.value),[m,E]=h.useState(-1),C=h.useRef(null),X=wr(f,C),ue=p=>w=>{var B;const N=Number(w.currentTarget.getAttribute("data-index"));Wt(w.target)&&E(N),D(N),(B=p==null?void 0:p.onFocus)==null||B.call(p,w)},he=p=>w=>{var N;Wt(w.target)||E(-1),D(-1),(N=p==null?void 0:p.onBlur)==null||N.call(p,w)},Be=(p,w)=>{const N=Number(p.currentTarget.getAttribute("data-index")),B=F[N],U=S.indexOf(B);let I=w;if(z&&A==null){const Q=S[S.length-1];I>=Q?I=Q:I<=S[0]?I=S[0]:I=I<B?S[U-1]:S[U+1]}if(I=Ie(I,l,a),W){s&&(I=Ie(I,F[N-1]||-1/0,F[N+1]||1/0));const Q=I;I=Ht({values:F,newValue:I,index:N});let re=N;s||(re=I.indexOf(Q)),Ze({sliderRef:C,activeIndex:re})}P(I),E(N),j&&!et(I,V)&&j(p,I,N),T&&T(p,q.current??I)},mt=p=>w=>{var N;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(w.key)){w.preventDefault();const B=Number(w.currentTarget.getAttribute("data-index")),U=F[B];let I=null;if(A!=null){const Q=w.shiftKey?L:A;switch(w.key){case"ArrowUp":I=Re(U,Q,1,l,a);break;case"ArrowRight":I=Re(U,Q,c?-1:1,l,a);break;case"ArrowDown":I=Re(U,Q,-1,l,a);break;case"ArrowLeft":I=Re(U,Q,c?1:-1,l,a);break;case"PageUp":I=Re(U,L,1,l,a);break;case"PageDown":I=Re(U,L,-1,l,a);break;case"Home":I=l;break;case"End":I=a;break}}else if(z){const Q=S[S.length-1],re=S.indexOf(U),J=[c?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"],oe=[c?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];J.includes(w.key)?re===0?I=S[0]:I=S[re-1]:oe.includes(w.key)&&(re===S.length-1?I=Q:I=S[re+1])}I!=null&&Be(w,I)}(N=p==null?void 0:p.onKeyDown)==null||N.call(p,w)};Zr(()=>{var p;n&&C.current.contains(document.activeElement)&&((p=document.activeElement)==null||p.blur())},[n]),n&&b!==-1&&v(-1),n&&m!==-1&&E(-1);const Ve=p=>w=>{var N;(N=p.onChange)==null||N.call(p,w),Be(w,w.target.valueAsNumber)},be=h.useRef(void 0);let ye=d;c&&d==="horizontal"&&(ye+="-reverse");const ve=({finger:p,move:w=!1})=>{const{current:N}=C,{width:B,height:U,bottom:I,left:Q}=N.getBoundingClientRect();let re;ye.startsWith("vertical")?re=(I-p.y)/U:re=(p.x-Q)/B,ye.includes("-reverse")&&(re=1-re);let J;if(J=Hn(re,l,a),A)J=Gn(J,A,l);else{const Ne=Yt(S,J);J=S[Ne]}J=Ie(J,l,a);let oe=0;if(W){w?oe=be.current:oe=Yt(F,J),s&&(J=Ie(J,F[oe-1]||-1/0,F[oe+1]||1/0));const Ne=J;J=Ht({values:F,newValue:J,index:oe}),s&&w||(oe=J.indexOf(Ne),be.current=oe)}return{newValue:J,activeIndex:oe}},we=St(p=>{const w=Ke(p,y);if(!w)return;if(R.current+=1,p.type==="mousemove"&&p.buttons===0){de(p);return}const{newValue:N,activeIndex:B}=ve({finger:w,move:!0});Ze({sliderRef:C,activeIndex:B,setActive:v}),P(N),!_&&R.current>Yn&&g(!0),j&&!et(N,V)&&j(p,N,B)}),de=St(p=>{const w=Ke(p,y);if(g(!1),!w)return;const{newValue:N}=ve({finger:w,move:!0});v(-1),p.type==="touchend"&&D(-1),T&&T(p,q.current??N),y.current=void 0,ke()}),ee=St(p=>{if(n)return;Jt()||p.preventDefault();const w=p.changedTouches[0];w!=null&&(y.current=w.identifier);const N=Ke(p,y);if(N!==!1){const{newValue:U,activeIndex:I}=ve({finger:N});Ze({sliderRef:C,activeIndex:I,setActive:v}),P(U),j&&!et(U,V)&&j(p,U,I)}R.current=0;const B=it(C.current);B.addEventListener("touchmove",we,{passive:!0}),B.addEventListener("touchend",de,{passive:!0})}),ke=h.useCallback(()=>{const p=it(C.current);p.removeEventListener("mousemove",we),p.removeEventListener("mouseup",de),p.removeEventListener("touchmove",we),p.removeEventListener("touchend",de)},[de,we]);h.useEffect(()=>{const{current:p}=C;return p.addEventListener("touchstart",ee,{passive:Jt()}),()=>{p.removeEventListener("touchstart",ee),ke()}},[ke,ee]),h.useEffect(()=>{n&&ke()},[n,ke]);const xt=p=>w=>{var U;if((U=p.onMouseDown)==null||U.call(p,w),n||w.defaultPrevented||w.button!==0)return;w.preventDefault();const N=Ke(w,y);if(N!==!1){const{newValue:I,activeIndex:Q}=ve({finger:N});Ze({sliderRef:C,activeIndex:Q,setActive:v}),P(I),j&&!et(I,V)&&j(w,I,Q)}R.current=0;const B=it(C.current);B.addEventListener("mousemove",we,{passive:!0}),B.addEventListener("mouseup",de)},_e=pt(W?F[0]:l,l,a),te=pt(F[F.length-1],l,a)-_e,$e=(p={})=>{const w=jt(p),N={onMouseDown:xt(w||{})},B={...w,...N};return{...p,ref:X,...B}},qe=p=>w=>{var B;(B=p.onMouseOver)==null||B.call(p,w);const N=Number(w.currentTarget.getAttribute("data-index"));D(N)},Ue=p=>w=>{var N;(N=p.onMouseLeave)==null||N.call(p,w),D(-1)},We=(p={})=>{const w=jt(p),N={onMouseOver:qe(w||{}),onMouseLeave:Ue(w||{})};return{...p,...w,...N}},Ye=p=>({pointerEvents:b!==-1&&b!==p?"none":void 0});let Ce;return d==="vertical"&&(Ce=c?"vertical-rl":"vertical-lr"),{active:b,axis:ye,axisProps:Qn,dragging:_,focusedThumbIndex:m,getHiddenInputProps:(p={})=>{const w=jt(p),N={onChange:Ve(w||{}),onFocus:ue(w||{}),onBlur:he(w||{}),onKeyDown:mt(w||{})},B={...w,...N};return{tabIndex:O,"aria-labelledby":t,"aria-orientation":d,"aria-valuemax":M(a),"aria-valuemin":M(l),name:u,type:"range",min:e.min,max:e.max,step:e.step===null&&e.marks?"any":e.step??void 0,disabled:n,...p,...B,style:{...Un,direction:c?"rtl":"ltr",width:"100%",height:"100%",writingMode:Ce}}},getRootProps:$e,getThumbProps:We,marks:z,open:$,range:W,rootRef:X,trackLeap:te,trackOffset:_e,values:F,getThumbStyle:Ye}}const Zn=e=>!e||!ct(e);function eo(e){return Oe("MuiSlider",e)}const ae=ze("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),to=e=>{const{open:t}=e;return{offset:ie(t&&ae.valueLabelOpen),circle:ae.valueLabelCircle,label:ae.valueLabelLabel}};function ro(e){const{children:t,className:r,value:n}=e,s=to(e);return t?h.cloneElement(t,{className:t.props.className},o.jsxs(h.Fragment,{children:[t.props.children,o.jsx("span",{className:ie(s.offset,r),"aria-hidden":!0,children:o.jsx("span",{className:s.circle,children:o.jsx("span",{className:s.label,children:n})})})]})):null}function Gt(e){return e}const no=G("span",{name:"MuiSlider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`color${H(r.color)}`],r.size!=="medium"&&t[`size${H(r.size)}`],r.marked&&t.marked,r.orientation==="vertical"&&t.vertical,r.track==="inverted"&&t.trackInverted,r.track===!1&&t.trackFalse]}})(le(({theme:e})=>({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${ae.disabled}`]:{pointerEvents:"none",cursor:"default",color:(e.vars||e).palette.grey[400]},[`&.${ae.dragging}`]:{[`& .${ae.thumb}, & .${ae.track}`]:{transition:"none"}},variants:[...Object.entries(e.palette).filter(De()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}))),oo=G("span",{name:"MuiSlider",slot:"Rail"})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),so=G("span",{name:"MuiSlider",slot:"Track"})(le(({theme:e})=>({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:e.transitions.create(["left","width","bottom","height"],{duration:e.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(e.palette).filter(De()).map(([t])=>({props:{color:t,track:"inverted"},style:{...e.vars?{backgroundColor:e.vars.palette.Slider[`${t}Track`],borderColor:e.vars.palette.Slider[`${t}Track`]}:{backgroundColor:Vt(e.palette[t].main,.62),borderColor:Vt(e.palette[t].main,.62),...e.applyStyles("dark",{backgroundColor:_t(e.palette[t].main,.5)}),...e.applyStyles("dark",{borderColor:_t(e.palette[t].main,.5)})}}}))]}))),ao=G("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.thumb,t[`thumbColor${H(r.color)}`],r.size!=="medium"&&t[`thumbSize${H(r.size)}`]]}})(le(({theme:e})=>({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:e.transitions.create(["box-shadow","left","bottom"],{duration:e.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(e.vars||e).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${ae.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(e.palette).filter(De()).map(([t])=>({props:{color:t},style:{[`&:hover, &.${ae.focusVisible}`]:{...e.vars?{boxShadow:`0px 0px 0px 8px rgba(${e.vars.palette[t].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 8px ${dt(e.palette[t].main,.16)}`},"@media (hover: none)":{boxShadow:"none"}},[`&.${ae.active}`]:{...e.vars?{boxShadow:`0px 0px 0px 14px rgba(${e.vars.palette[t].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 14px ${dt(e.palette[t].main,.16)}`}}}}))]}))),io=G(ro,{name:"MuiSlider",slot:"ValueLabel"})(le(({theme:e})=>({zIndex:1,whiteSpace:"nowrap",...e.typography.body2,fontWeight:500,transition:e.transitions.create(["transform"],{duration:e.transitions.duration.shortest}),position:"absolute",backgroundColor:(e.vars||e).palette.grey[600],borderRadius:2,color:(e.vars||e).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${ae.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${ae.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:e.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}))),lo=G("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:e=>jr(e)&&e!=="markActive",overridesResolver:(e,t)=>{const{markActive:r}=e;return[t.mark,r&&t.markActive]}})(le(({theme:e})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(e.vars||e).palette.background.paper,opacity:.8}}]}))),co=G("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:e=>jr(e)&&e!=="markLabelActive"})(le(({theme:e})=>({...e.typography.body2,color:(e.vars||e).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(e.vars||e).palette.text.primary}}]}))),uo=e=>{const{disabled:t,dragging:r,marked:n,orientation:s,track:c,classes:i,color:a,size:l}=e,u={root:["root",t&&"disabled",r&&"dragging",n&&"marked",s==="vertical"&&"vertical",c==="inverted"&&"trackInverted",c===!1&&"trackFalse",a&&`color${H(a)}`,l&&`size${H(l)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",t&&"disabled",l&&`thumbSize${H(l)}`,a&&`thumbColor${H(a)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return Ae(u,eo,i)},po=({children:e})=>e,fo=h.forwardRef(function(t,r){const n=Pe({props:t,name:"MuiSlider"}),s=Cr(),{"aria-label":c,"aria-valuetext":i,"aria-labelledby":a,component:l="span",components:u={},componentsProps:x={},color:T="primary",classes:d,className:f,disableSwap:M=!1,disabled:A=!1,getAriaLabel:L,getAriaValueText:O,marks:k=!1,max:y=100,min:b=0,name:v,onChange:$,onChangeCommitted:D,orientation:_="horizontal",shiftStep:g=10,size:R="medium",step:q=1,scale:V=Gt,slotProps:P,slots:j,tabIndex:W,track:F="normal",value:z,valueLabelDisplay:S="off",valueLabelFormat:m=Gt,...E}=n,C={...n,isRtl:s,max:y,min:b,classes:d,disabled:A,disableSwap:M,orientation:_,marks:k,color:T,size:R,step:q,shiftStep:g,scale:V,track:F,valueLabelDisplay:S,valueLabelFormat:m},{axisProps:X,getRootProps:ue,getHiddenInputProps:he,getThumbProps:Be,open:mt,active:Ve,axis:be,focusedThumbIndex:ye,range:ve,dragging:we,marks:de,values:ee,trackOffset:ke,trackLeap:xt,getThumbStyle:_e}=Kn({...C,rootRef:r});C.marked=de.length>0&&de.some(Y=>Y.label),C.dragging=we,C.focusedThumbIndex=ye;const te=uo(C),$e=(j==null?void 0:j.root)??u.Root??no,qe=(j==null?void 0:j.rail)??u.Rail??oo,Ue=(j==null?void 0:j.track)??u.Track??so,We=(j==null?void 0:j.thumb)??u.Thumb??ao,Ye=(j==null?void 0:j.valueLabel)??u.ValueLabel??io,Ce=(j==null?void 0:j.mark)??u.Mark??lo,He=(j==null?void 0:j.markLabel)??u.MarkLabel??co,p=(j==null?void 0:j.input)??u.Input??"input",w=(P==null?void 0:P.root)??x.root,N=(P==null?void 0:P.rail)??x.rail,B=(P==null?void 0:P.track)??x.track,U=(P==null?void 0:P.thumb)??x.thumb,I=(P==null?void 0:P.valueLabel)??x.valueLabel,Q=(P==null?void 0:P.mark)??x.mark,re=(P==null?void 0:P.markLabel)??x.markLabel,J=(P==null?void 0:P.input)??x.input,oe=me({elementType:$e,getSlotProps:ue,externalSlotProps:w,externalForwardedProps:E,additionalProps:{...Zn($e)&&{as:l}},ownerState:{...C,...w==null?void 0:w.ownerState},className:[te.root,f]}),Ne=me({elementType:qe,externalSlotProps:N,ownerState:C,className:te.rail}),Fr=me({elementType:Ue,externalSlotProps:B,additionalProps:{style:{...X[be].offset(ke),...X[be].leap(xt)}},ownerState:{...C,...B==null?void 0:B.ownerState},className:te.track}),bt=me({elementType:We,getSlotProps:Be,externalSlotProps:U,ownerState:{...C,...U==null?void 0:U.ownerState},className:te.thumb}),zr=me({elementType:Ye,externalSlotProps:I,ownerState:{...C,...I==null?void 0:I.ownerState},className:te.valueLabel}),yt=me({elementType:Ce,externalSlotProps:Q,ownerState:C,className:te.mark}),vt=me({elementType:He,externalSlotProps:re,ownerState:C,className:te.markLabel}),Or=me({elementType:p,getSlotProps:he,externalSlotProps:J,ownerState:C});return o.jsxs($e,{...oe,children:[o.jsx(qe,{...Ne}),o.jsx(Ue,{...Fr}),de.filter(Y=>Y.value>=b&&Y.value<=y).map((Y,K)=>{const wt=pt(Y.value,b,y),Je=X[be].offset(wt);let pe;return F===!1?pe=ee.includes(Y.value):pe=F==="normal"&&(ve?Y.value>=ee[0]&&Y.value<=ee[ee.length-1]:Y.value<=ee[0])||F==="inverted"&&(ve?Y.value<=ee[0]||Y.value>=ee[ee.length-1]:Y.value>=ee[0]),o.jsxs(h.Fragment,{children:[o.jsx(Ce,{"data-index":K,...yt,...!ct(Ce)&&{markActive:pe},style:{...Je,...yt.style},className:ie(yt.className,pe&&te.markActive)}),Y.label!=null?o.jsx(He,{"aria-hidden":!0,"data-index":K,...vt,...!ct(He)&&{markLabelActive:pe},style:{...Je,...vt.style},className:ie(te.markLabel,vt.className,pe&&te.markLabelActive),children:Y.label}):null]},K)}),ee.map((Y,K)=>{const wt=pt(Y,b,y),Je=X[be].offset(wt),pe=S==="off"?po:Ye;return o.jsx(pe,{...!ct(pe)&&{valueLabelFormat:m,valueLabelDisplay:S,value:typeof m=="function"?m(V(Y),K):m,index:K,open:mt===K||Ve===K||S==="on",disabled:A},...zr,children:o.jsx(We,{"data-index":K,...bt,className:ie(te.thumb,bt.className,Ve===K&&te.active,ye===K&&te.focusVisible),style:{...Je,..._e(K),...bt.style},children:o.jsx(p,{"data-index":K,"aria-label":L?L(K):c,"aria-valuenow":V(Y),"aria-labelledby":a,"aria-valuetext":O?O(V(Y),K):i,value:ee[K],...Or})})},K)})]})});function go(e){return Oe("MuiTableContainer",e)}ze("MuiTableContainer",["root"]);const ho=e=>{const{classes:t}=e;return Ae({root:["root"]},go,t)},mo=G("div",{name:"MuiTableContainer",slot:"Root"})({width:"100%",overflowX:"auto"}),xo=h.forwardRef(function(t,r){const n=Pe({props:t,name:"MuiTableContainer"}),{className:s,component:c="div",...i}=n,a={...n,component:c},l=ho(a);return o.jsx(mo,{ref:r,as:c,className:ie(l.root,s),ownerState:a,...i})}),bo=xe(o.jsx("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}));function yo(e){return Oe("MuiTableSortLabel",e)}const Pt=ze("MuiTableSortLabel",["root","active","icon","iconDirectionDesc","iconDirectionAsc","directionDesc","directionAsc"]),vo=e=>{const{classes:t,direction:r,active:n}=e,s={root:["root",n&&"active",`direction${H(r)}`],icon:["icon",`iconDirection${H(r)}`]};return Ae(s,yo,t)},wo=G(en,{name:"MuiTableSortLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.active&&t.active]}})(le(({theme:e})=>({cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:(e.vars||e).palette.text.secondary},"&:hover":{color:(e.vars||e).palette.text.secondary,[`& .${Pt.icon}`]:{opacity:.5}},[`&.${Pt.active}`]:{color:(e.vars||e).palette.text.primary,[`& .${Pt.icon}`]:{opacity:1,color:(e.vars||e).palette.text.secondary}}}))),ko=G("span",{name:"MuiTableSortLabel",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.icon,t[`iconDirection${H(r.direction)}`]]}})(le(({theme:e})=>({fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:e.transitions.create(["opacity","transform"],{duration:e.transitions.duration.shorter}),userSelect:"none",variants:[{props:{direction:"desc"},style:{transform:"rotate(0deg)"}},{props:{direction:"asc"},style:{transform:"rotate(180deg)"}}]}))),So=h.forwardRef(function(t,r){const n=Pe({props:t,name:"MuiTableSortLabel"}),{active:s=!1,children:c,className:i,direction:a="asc",hideSortIcon:l=!1,IconComponent:u=bo,slots:x={},slotProps:T={},...d}=n,f={...n,active:s,direction:a,hideSortIcon:l,IconComponent:u},M=vo(f),A={slots:x,slotProps:T},[L,O]=Se("root",{elementType:wo,externalForwardedProps:A,ownerState:f,className:ie(M.root,i),ref:r}),[k,y]=Se("icon",{elementType:ko,externalForwardedProps:A,ownerState:f,className:M.icon});return o.jsxs(L,{disableRipple:!0,component:"span",...O,...d,children:[c,l&&!s?null:o.jsx(k,{as:u,...y})]})});function Nr(e){var t=Ge(.1),r,n,s;typeof e!="function"&&(e=Ge(e==null?0:+e));function c(a){for(var l=0,u=r.length,x;l<u;++l)x=r[l],x.vy+=(s[l]-x.y)*n[l]*a}function i(){if(r){var a,l=r.length;for(n=new Array(l),s=new Array(l),a=0;a<l;++a)n[a]=isNaN(s[a]=+e(r[a],a,r))?0:+t(r[a],a,r)}}return c.initialize=function(a){r=a,i()},c.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Ge(+a),i(),c):t},c.y=function(a){return arguments.length?(e=typeof a=="function"?a:Ge(+a),i(),c):e},c}function Ir(){const e={0:"Invisible",1:"Private",2:"Shareable",3:"Public"};function t(n){return e[n]}function r(n){const c=Object.entries(e).find(([i,a])=>a===n);return parseInt((c==null?void 0:c[0])||"0",10)}return{toString:t,toInt:r}}Ir().toInt("Shareable");const jo={parent:"",visibility:Ir().toInt("Shareable"),metadata:{name:"Uploaded Answer",answerOnly:!0,hasAnswers:!0}};function Co(e,t,r,n){const s=e*t*.5;return c=>{const a=s*c/n/r;let l=Math.sqrt(a/Math.PI);return l=Math.min(l,t/2*.9),l}}function Mr(e,t){return t.sort((n,s)=>{const c=e[n]&&e[n].length||0,i=e[s]&&e[s].length||0;return c-i})}function Ro(e,t){const r={};e.results.forEach(s=>{Object.values(s.node_bindings).forEach(c=>{c.forEach(i=>{let a=r[i.id];if(a)a.count+=1;else{a=Qr(i);const l=e.knowledge_graph.nodes[String(a.id)];let u=l.categories;u&&!Array.isArray(u)&&(u=[u]),u=Array.isArray(u)?u:u?[u]:[],u=Mr(t,u),a.categories=u,a.name=l.name,a.count=1}r[i.id]=a})})});const n=Object.values(r);return n.sort((s,c)=>c.count-s.count),n}function Po(e){let{nodes:t,edges:r}=e.knowledge_graph;return t=Object.entries(t).map(([n,s])=>{const c=s,i={id:n,name:c.name,categories:c.categories};return i.categories&&!Array.isArray(i.categories)&&(i.categories=[i.categories]),i}),r=Object.entries(r).map(([n,s])=>{const c=s,i={id:n,source:c.subject,target:c.object,predicates:c.predicates};return i.predicates&&!Array.isArray(i.predicates)&&(i.predicates=[i.predicates]),i}),{nodes:t,edges:r}}const ft={makeDisplayNodes:Ro,getFullDisplay:Po,getRankedCategories:Mr,getNodeRadius:Co};function Ao(e){const t=Object.entries(e.nodes??{}).map(([i,a])=>{var l;return{key:i,pinned:!!(typeof a=="object"&&a&&Array.isArray(a.ids)&&(((l=a.ids)==null?void 0:l.length)??0)>0)}}),r=Xr.getNumEdgesPerNode({edges:e.edges??{}}),n=t.filter(i=>!i.pinned&&i.key in r),s=t.filter(i=>i.pinned&&i.key in r);let c=t.length&&t[0].key||null;return s.length?(s.sort((i,a)=>r[i.key]-r[a.key]),c=s[0].key):n.length&&(n.sort((i,a)=>r[i.key]-r[a.key]),c=n[0].key),c}function Ft(e,t){const r=t[t.length-1];Object.keys(e).filter(s=>{const c=e[s];return c.subject===r||c.object===r}).forEach(s=>{const{subject:c,object:i}=e[s],a=t.indexOf(c);t.indexOf(i)===-1&&(t.push(i),Ft(e,t)),a===-1&&(t.push(c),Ft(e,t))})}function To(e,t){const r=[t];Ft(e.edges,r);const n=Object.keys(e.nodes).filter(s=>r.indexOf(s)===-1);return[...r,...n]}function $o(e,t,r,n){const i=Math.max(...e.map(a=>(r[a.node_bindings[t][0].id].name||"").length),n.length);return Math.min(400,i*10)}function No(e,t){const{query_graph:r,knowledge_graph:n,results:s}=e,c=Ao(r);if(!c)return[];const a=To(r,c).map(l=>{const u=r.nodes[l],x=t(u.categories)[1],T=ut.getTableHeaderLabel(u),d=u.name||T||ge.displayCategory(u.categories)||"Something",f=$o(s,l,n.nodes,d);return{Header:`${d} (${l})`,color:x,id:l,accessor:M=>{const A=M.node_bindings[l];return!A||A.length===0?"":A.length>1?`Set of ${ge.displayCategory(u.categories)} [${A.length}]`:n.nodes[A[0].id].name||A[0].id},Cell:({value:M})=>M||"Unknown",disableSortBy:!0,width:f,filter:"equals"}});if(s.length&&s[0].score){const l={Header:"Score",color:void 0,id:"score",accessor:u=>typeof u.score=="number"?Math.round(u.score*1e3)/1e3:void 0,Cell:({value:u})=>u??"Unknown",disableSortBy:!1,width:30,filter:"equals",sortDescFirst:!0,disableFilters:!0};a.push(l)}return a}const Io="https://www.ncbi.nlm.nih.gov/pubmed/";function Mo(e){const t=[],r=e.attributes&&Array.isArray(e.attributes)&&e.attributes.filter(n=>n.attribute_type_id==="biolink:publications"||n.attribute_type_id==="biolink:Publication"||n.attribute_type_id==="publications"||n.type==="EDAM:data_0971");return Array.isArray(r)&&r.forEach(n=>{n.value_url?t.push(n.value_url):n.value&&(Array.isArray(n.value)||(n.value=[n.value]),n.value.forEach(s=>{typeof s=="string"&&s.startsWith("PMID:")&&t.push(Io+s.split(":")[1])}))}),t}const Qt={makeTableHeaders:No,getPublications:Mo};function Lo(){const[e,t]=h.useState({}),[r,n]=h.useState([]),[s,c]=h.useState({nodes:{},edges:{}}),[i,a]=h.useState(""),[l,u]=h.useState({}),[x,T]=h.useState({}),{colorMap:d,hierarchies:f}=h.useContext(gt)||{};function M(){c({nodes:{},edges:{}}),a(""),u({}),T({})}function A($){if(!$.results)return $;const D=$.results.map(_=>{const g=_.analyses.reduce((R,q)=>R+q.score,0)/_.analyses.length;return{..._,score:g}});return{...$,results:D}}function L($,D){t(A($)),$.knowledge_graph&&$.results?(n(ft.makeDisplayNodes($,f||{})),D({type:"toggle",payload:{component:"results",show:!0}})):D({type:"disable",payload:{component:"results"}}),M()}function O(){t({}),n([]),M()}function k($,D){if(D===i)M();else{const _={},g={},R={};Object.entries($.node_bindings).forEach(([P,j])=>{const W=j.length;j.forEach(F=>{var S;const z=(S=e.knowledge_graph)==null?void 0:S.nodes[F.id];if(R[F.id]=z||"Unknown",z){let{categories:m}=z;m&&!Array.isArray(m)&&(m=[m]),m=ft.getRankedCategories(f||{},Array.isArray(m)?m:m?[m]:[]);const E={id:F.id,name:z.name||F.id||m[0]||"",categories:m||[],qg_id:P,is_set:!1,score:W>1?0:1/0};g[F.id]=E}})});const q={},V={};$.analyses.forEach(P=>{const j=Object.values(P.edge_bindings).flat(),W=[];Array.isArray(P.support_graphs)&&P.support_graphs.forEach(F=>{var S;const z=(S=e.auxiliary_graphs)==null?void 0:S[F];z&&W.push(...z.edges.map(m=>({id:m})))}),[...j,...W].forEach(F=>{var S,m,E;const z=(S=e.knowledge_graph)==null?void 0:S.edges[F.id];if(V[F.id]=z||"Unknown",z){const C={id:F.id,source:z.subject,target:z.object,predicate:z.predicate};q[F.id]=C,z.subject in g&&(g[z.subject].score+=1),z.object in g&&(g[z.object].score+=1);const X=(m=e.knowledge_graph)==null?void 0:m.nodes[z.subject],ue=(E=e.knowledge_graph)==null?void 0:E.nodes[z.object],he=`${(X==null?void 0:X.name)||z.subject} ${ge.displayPredicate(z.predicate)} ${(ue==null?void 0:ue.name)||z.object}`;_[he]=Qt.getPublications(z)}})}),c({nodes:g,edges:q}),a(D),u(_),T({knowledge_graph:{nodes:R,edges:V},result:$})}}const y=h.useMemo(()=>e.query_graph&&e.knowledge_graph&&e.results?Qt.makeTableHeaders(e,d||(()=>[null,""])):[],[e,d]),b=h.useMemo(()=>Object.keys(x).length>0&&x.result&&Object.values(x.result.node_bindings).some($=>$.length>3),[x]),v=h.useMemo(()=>y.length,[y]);return{initialize:L,reset:O,message:e,kgNodes:r,tableHeaders:y,selectedResult:s,selectedRowId:i,resultJSON:x,selectRow:k,showNodePruneSlider:b,numQgNodes:v,metaData:l}}function Eo(e,t){switch(t.type){case"toggle":{const{component:r,show:n}=t.payload;e[r].show=n,e[r].disabled=!1;break}case"disable":{const{component:r}=t.payload;e[r].show=!1,e[r].disabled=!0;break}default:return{...e}}return{...e}}function Do(){const[e,t]=h.useReducer(Eo,{qg:{show:!0,label:"Query Graph"},kgFull:{show:!1,label:"Knowledge Graph",disabled:!0},results:{show:!0,label:"Results Table"}});return{displayState:e,updateDisplayState:t}}const Fo=xe(o.jsx("path",{d:"M5 4v2h14V4zm0 10h4v6h6v-6h4l-7-7z"})),Xt=xe(o.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}));function zo({onUpload:e,displayState:t,updateDisplayState:r,message:n,saveAnswer:s,deleteAnswer:c,owned:i}){const[a,l]=h.useState(!1);function u(x,T){r({type:"toggle",payload:{component:x,show:T}})}return o.jsxs(Vn,{container:document.getElementById("contentContainer"),variant:"permanent",open:!0,classes:{paper:"leftDrawer"},children:[o.jsx(un,{}),o.jsxs(at,{children:[Object.entries(t).map(([x,T])=>o.jsxs(Ee,{onClick:()=>u(x,!T.show),disabled:T.disabled,children:[o.jsx(Xe,{children:o.jsx($n,{checked:T.show,disableRipple:!0})}),o.jsx(je,{primary:T.label})]},x)),o.jsxs(Ee,{disabled:!Object.keys(n).length,onClick:()=>{l(!0)},children:[o.jsx(Xe,{children:o.jsx(lt,{component:"span",style:{fontSize:"18px"},title:"Download",disableRipple:!0,children:o.jsx(Xt,{})})}),o.jsx(je,{primary:"Download Query"})]}),o.jsxs(Ee,{disabled:!Object.keys(n).length,onClick:()=>{l(!0)},children:[o.jsx(Xe,{children:o.jsx(lt,{component:"span",style:{fontSize:"18px"},title:"Download",disableRipple:!0,children:o.jsx(Xt,{})})}),o.jsx(je,{primary:"Download Answer"})]}),o.jsxs(Ee,{component:"label",children:[o.jsx(Xe,{children:o.jsx(lt,{component:"span",style:{fontSize:"18px"},title:"Upload Answer",disableRipple:!0,children:o.jsx(Fo,{})})}),o.jsx(je,{primary:"Upload Answer"}),o.jsx("input",{accept:".json",hidden:!0,style:{display:"none"},type:"file",onChange:x=>e(x)})]})]}),o.jsx(Ur,{open:a,setOpen:l,message:n})]})}function Oo(e){return new Worker("/assets/simulation.worker-D4TtnuFj.js",{name:e==null?void 0:e.name})}const rt=400,nt=400;function Bo({message:e}){const t=h.useRef(null),[r,n]=h.useState(!1),[s,c]=h.useState(0),{colorMap:i,hierarchies:a}=h.useContext(gt);function l(x){var O;const d=(O=ne(t.current).attr("width",nt).attr("height",rt).node())==null?void 0:O.getContext("2d");if(!d)return;const{nodes:f,edges:M}=x;d.clearRect(0,0,nt,rt),d.save(),d.translate(nt/2,rt/2);function A(k){d&&(d.moveTo(k.source.x,k.source.y),d.lineTo(k.target.x,k.target.y))}function L(k){if(!d)return;d.beginPath(),d.moveTo(k.x+5,k.y),d.arc(k.x,k.y,5,0,2*Math.PI),k.categories&&Array.isArray(k.categories)&&(k.categories=ft.getRankedCategories(a||{},k.categories));const y=i&&k.categories?i(k.categories)[1]:"#000";d.strokeStyle=y,d.fillStyle=y,d.fill(),d.stroke()}d.beginPath(),M.forEach(A),d.strokeStyle="#aaa",d.stroke(),f.forEach(L),d.restore()}function u(){const x=new Oo,T=ft.getFullDisplay(e);n(!0),x.onmessage=d=>{switch(d.data.type){case"display":{l(d.data),n(!1),x.terminate();break}case"tick":{d.data.progress!==void 0&&c(d.data.progress);break}default:console.log("unhandled worker message")}},x.postMessage(T)}return h.useEffect(()=>{t.current&&ne(t.current).attr("width",0).attr("height",0),Object.keys(e).length&&u()},[e]),o.jsx(o.Fragment,{children:o.jsxs("div",{id:"kgFullContainer",style:{height:rt,width:nt,display:"inline-block"},children:[r&&o.jsxs(Fe,{position:"relative",display:"inline-flex",children:[o.jsx(tn,{variant:"determinate",value:s,size:150}),o.jsx(Fe,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:`${Math.round(s)}%`})]}),o.jsx("canvas",{ref:t})]})})}const Me=48,Vo=225;function _o({query_graph:e}){const t=h.useRef(null),{colorMap:r,predicates:n=[]}=h.useContext(gt),[s,c]=h.useState(!1),i=n.filter(u=>u.symmetric).map(u=>u.predicate);function a(){var f,M;const u=t.current;if(!u)return;const x=ne(u),{width:T,height:d}=(M=(f=x.node())==null?void 0:f.parentNode)==null?void 0:M.getBoundingClientRect();x.attr("width",T).attr("height",d).attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",[0,0,T,d])}h.useEffect(()=>{a()},[]);function l(){var k,y;let{nodes:u,edges:x}=ut.getNodeAndEdgeListsForDisplay(e);const T=ne(t.current),{width:d,height:f}=(y=(k=T.node())==null?void 0:k.parentNode)==null?void 0:y.getBoundingClientRect();T.selectAll("*").remove(),T.append("defs").append("marker").attr("id","arrow").attr("viewBox",[0,0,20,13]).attr("refX",20).attr("refY",6.5).attr("markerWidth",6.5).attr("markerHeight",25).attr("orient","auto-start-reverse").append("path").attr("d",fr()([[0,0],[0,13],[25,6.5]])).attr("fill","#999");let A=T.append("g").attr("id","nodeContainer").selectAll("g"),L=T.append("g").attr("id","edgeContainer").selectAll("g");u=u.map(b=>({...b,x:Math.random()*d,y:Math.random()*f}));const O=gr(u).force("center",hr(d/2,f/2).strength(.5)).force("forceY",Nr(f/2).strength(.2)).force("collide",mr().radius(Me*2)).force("link",xr(x).id(b=>b.id).distance(Vo).strength(0)).on("tick",()=>{A.attr("transform",b=>{let v=Me;return b.fx!==null&&b.fx!==void 0&&(v*=.5),b.x=se.getBoundedValue(b.x,d-v,v),b.y=se.getBoundedValue(b.y,f-v,v),`translate(${b.x}, ${b.y})`}),L.select(".edge").attr("d",b=>{const{x1:v,y1:$,qx:D,qy:_,x2:g,y2:R}=se.getCurvedEdgePos(b.source.x,b.source.y,b.target.x,b.target.y,b.numEdges,b.index,Me);return`M${v},${$}Q${D},${_} ${g},${R}`}),L.select(".edgeTransparent").attr("d",b=>{const{x1:v,y1:$,qx:D,qy:_,x2:g,y2:R}=se.getCurvedEdgePos(b.source.x,b.source.y,b.target.x,b.target.y,b.numEdges,b.index,Me),q=v>g?`${g},${R}`:`${v},${$}`,V=v>g?`${v},${$}`:`${g},${R}`;return`M${q}Q${D},${_} ${V}`})});A=A.data(u).enter().append("g").attr("class","node").call(br.dragNode(O)).call(b=>b.append("circle").attr("r",Me).attr("fill",v=>r(v.categories)[1]).call(v=>v.append("title").text($=>$.name))).call(b=>b.append("text").attr("class","nodeLabel").style("pointer-events","none").attr("text-anchor","middle").style("font-weight",600).attr("alignment-baseline","middle").text(v=>{const{name:$}=v;return $||"Any"}).each(se.fitTextIntoCircle)),x=yr.addEdgeCurveProperties(x),L=L.data(x).enter().append("g").call(b=>b.append("path").attr("stroke","#999").attr("fill","none").attr("stroke-width",v=>v.strokeWidth).attr("class","edge").attr("marker-end",v=>se.shouldShowArrow(v,i)?"url(#arrow)":"")).call(b=>b.append("path").attr("stroke","transparent").attr("fill","none").attr("stroke-width",10).attr("class","edgeTransparent").attr("id",v=>`edge${v.id}`).call(()=>b.append("text").attr("class","edgeText").attr("pointer-events","none").style("text-anchor","middle").attr("dy",v=>-v.strokeWidth).append("textPath").attr("pointer-events","none").attr("xlink:href",v=>`#edge${v.id}`).attr("startOffset","50%").text(v=>v.predicates?v.predicates.map($=>ge.displayPredicate($)).join(" or "):"")).call(v=>v.append("title").text($=>$.predicates?$.predicates.map(D=>ge.displayPredicate(D)).join(" or "):""))),O.alpha(1).restart()}return h.useEffect(()=>{e&&l()},[e,r]),h.useEffect(()=>{let u;function x(){ne(t.current).selectAll("*").remove(),c(!0),clearTimeout(u),u=setTimeout(()=>{a(),l(),c(!1)},1e3)}return window.addEventListener("resize",x),()=>{window.removeEventListener("resize",x)}},[e]),o.jsxs(Te,{id:"queryGraphContainer",elevation:3,children:[o.jsx("h5",{className:"cardLabel",children:"Question Graph"}),s&&o.jsx(pn,{positionStatic:!0,message:"Redrawing question graph..."}),o.jsx("svg",{ref:t})]})}const Kt=xe(o.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),Zt=xe(o.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}));var At={exports:{}},Tt,er;function qo(){if(er)return Tt;er=1;var e=1;function t(){return e=(e*9301+49297)%233280,e/233280}function r(n){e=n}return Tt={nextValue:t,seed:r},Tt}var $t,tr;function ht(){if(tr)return $t;tr=1;var e=qo(),t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-",r,n,s;function c(){s=!1}function i(f){if(!f){r!==t&&(r=t,c());return}if(f!==r){if(f.length!==t.length)throw new Error("Custom alphabet for shortid must be "+t.length+" unique characters. You submitted "+f.length+" characters: "+f);var M=f.split("").filter(function(A,L,O){return L!==O.lastIndexOf(A)});if(M.length)throw new Error("Custom alphabet for shortid must be "+t.length+" unique characters. These characters were not unique: "+M.join(", "));r=f,c()}}function a(f){return i(f),r}function l(f){e.seed(f),n!==f&&(c(),n=f)}function u(){r||i(t);for(var f=r.split(""),M=[],A=e.nextValue(),L;f.length>0;)A=e.nextValue(),L=Math.floor(A*f.length),M.push(f.splice(L,1)[0]);return M.join("")}function x(){return s||(s=u(),s)}function T(f){var M=x();return M[f]}function d(){return r||t}return $t={get:d,characters:a,seed:l,lookup:T,shuffled:x},$t}var Nt,rr;function Uo(){if(rr)return Nt;rr=1;var e=typeof window=="object"&&(window.crypto||window.msCrypto),t;return!e||!e.getRandomValues?t=function(r){for(var n=[],s=0;s<r;s++)n.push(Math.floor(Math.random()*256));return n}:t=function(r){return e.getRandomValues(new Uint8Array(r))},Nt=t,Nt}let Wo="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Lr=e=>crypto.getRandomValues(new Uint8Array(e)),Er=(e,t,r)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,s=-~(1.6*n*t/e.length);return(c=t)=>{let i="";for(;;){let a=r(s),l=s|0;for(;l--;)if(i+=e[a[l]&n]||"",i.length===c)return i}}},Yo=(e,t=21)=>Er(e,t,Lr),Ho=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,r)=>(r&=63,r<36?t+=r.toString(36):r<62?t+=(r-26).toString(36).toUpperCase():r>62?t+="-":t+="_",t),"");const Jo=Object.freeze(Object.defineProperty({__proto__:null,customAlphabet:Yo,customRandom:Er,nanoid:Ho,random:Lr,urlAlphabet:Wo},Symbol.toStringTag,{value:"Module"})),Go=Br(Jo);var It,nr;function Qo(){if(nr)return It;nr=1;var e=ht(),t=Uo(),r=Go.customRandom;function n(s){for(var c=0,i,a="";!i;)a=a+r(e.get(),1,t)(),i=s<Math.pow(16,c+1),c++;return a}return It=n,It}var Mt,or;function Xo(){if(or)return Mt;or=1;var e=Qo();ht();var t=1567752802062,r=7,n,s;function c(i){var a="",l=Math.floor((Date.now()-t)*.001);return l===s?n++:(n=0,s=l),a=a+e(r),a=a+e(i),n>0&&(a=a+e(n)),a=a+e(l),a}return Mt=c,Mt}var Lt,sr;function Ko(){if(sr)return Lt;sr=1;var e=ht();function t(r){if(!r||typeof r!="string"||r.length<6)return!1;var n=new RegExp("[^"+e.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]");return!n.test(r)}return Lt=t,Lt}var Et,ar;function Zo(){return ar||(ar=1,Et=0),Et}var ir;function es(){return ir||(ir=1,function(e){var t=ht(),r=Xo(),n=Ko(),s=Zo()||0;function c(u){return t.seed(u),e.exports}function i(u){return s=u,e.exports}function a(u){return u!==void 0&&t.characters(u),t.shuffled()}function l(){return r(s)}e.exports=l,e.exports.generate=l,e.exports.seed=c,e.exports.worker=i,e.exports.characters=a,e.exports.isValid=n}(At)),At.exports}var Dt,lr;function ts(){return lr||(lr=1,Dt=es()),Dt}var rs=ts();const cr=Vr(rs);function ns(e,t){switch(t.type){case"toggle":t.key&&(e[t.key]=!e[t.key]);break;case"clear":return{}}return{...e}}function os({metaData:e,result:t}){const[r,n]=h.useReducer(ns,{}),[s,c]=h.useState(!1);h.useEffect(()=>{n({type:"clear"})},[e]);const i=h.useMemo(()=>!!Object.values(e).find(a=>a.length>0),[e]);return o.jsxs(Te,{id:"resultMetaData",elevation:3,children:[o.jsxs("div",{children:[o.jsx("h4",{children:"Supporting Publications"}),i?o.jsx(at,{children:Object.entries(e).map(([a,l])=>o.jsx(st.Fragment,{children:l.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs(Ee,{onClick:()=>n({type:"toggle",key:a}),children:[o.jsx(je,{primary:a}),r[a]?o.jsx(Kt,{}):o.jsx(Zt,{})]}),o.jsx(fn,{in:r[a],timeout:"auto",unmountOnExit:!0,children:o.jsx(at,{component:"div",children:l.map(u=>o.jsx(Ut,{component:"a",href:u,target:"_blank",rel:"noreferrer",children:o.jsx(je,{primary:u,inset:!0})},cr.generate()))})})]})},cr.generate()))}):o.jsx(at,{children:o.jsx(Ut,{children:o.jsx(je,{primary:"No Supporting Publications Found"})})})]}),o.jsxs("div",{children:[o.jsxs("h4",{children:["Result JSON ",o.jsx(lt,{onClick:()=>c(!s),children:s?o.jsx(Kt,{}):o.jsx(Zt,{})})]}),s&&o.jsx("pre",{id:"resultJSONContainer",children:JSON.stringify(t,null,2)})]})]})}const ur={fontWeight:"bold",backgroundColor:"#eee"},ss=G(Ot)(()=>({"& .MuiTableRow-root:last-of-type .MuiTableCell-root":{borderBottom:"none"}})),as=({value:e})=>o.jsx(Z,{children:o.jsx("ul",{style:{padding:0,margin:0,listStyleType:"none"},children:Array.isArray(e)?e.map((t,r)=>o.jsx("li",{children:t},r)):o.jsx("li",{children:e})})}),is=({value:e})=>{const t=r=>{const n=r.split(":");return n.length!==2?null:n[0]==="PMC"?`https://pmc.ncbi.nlm.nih.gov/articles/${n[0]}${n[1]}/`:n[0]==="PMID"?`https://pubmed.ncbi.nlm.nih.gov/${n[1]}/`:null};return o.jsx(Z,{children:o.jsx("ul",{style:{padding:0,margin:0,listStyleType:"none"},children:Array.isArray(e)?e.map((r,n)=>{const s=t(r);return o.jsx("li",{children:s===null?r:o.jsx("a",{href:s,target:"_blank",rel:"noreferrer",children:r})},n)}):o.jsx("li",{children:t(e)===null?e:o.jsx("a",{href:t(e)||"#",target:"_blank",rel:"noreferrer",children:e})})})})},ls=({attributes:e,sources:t})=>o.jsx(Fe,{style:{maxHeight:500,overflow:"auto"},children:o.jsxs(zt,{size:"small","aria-label":"edge attributes table",children:[o.jsx(Pr,{style:{position:"sticky",top:0},children:o.jsxs(ce,{children:[o.jsx(Z,{style:ur,children:"attribute_type_id"}),o.jsx(Z,{style:ur,children:"value"})]})}),o.jsxs(ss,{children:[e.map((r,n)=>o.jsxs(ce,{children:[o.jsx(Z,{style:{verticalAlign:"top"},children:r.attribute_type_id}),r.attribute_type_id==="biolink:publications"?o.jsx(is,{value:r.value}):o.jsx(as,{value:r.value})]},n)),o.jsxs(ce,{children:[o.jsx(Z,{children:"Sources"}),o.jsx(Z,{children:Array.isArray(t)&&t.map((r,n)=>o.jsxs("section",{children:[o.jsx("p",{style:{marginBottom:"0px",fontStyle:"italic"},children:r.resource_id}),o.jsx("p",{style:{filter:"opacity(0.75)",fontSize:"0.8em"},children:r.resource_role}),!!r.upstream_resource_ids&&Array.isArray(r.upstream_resource_ids)&&o.jsxs(o.Fragment,{children:[o.jsx("p",{style:{marginBottom:"0px"},children:"Upstream resource ids:"}),o.jsx("ul",{children:r.upstream_resource_ids.map((s,c)=>o.jsx("li",{children:s},c))})]}),n===t.length-1?null:o.jsx("hr",{})]},n))})]})]})]})}),Dr=G(Te)(({theme:e})=>({filter:"drop-shadow(0px 4px 6px rgba(0, 0, 0, 0.3))",position:"relative","&::before":{content:'""',display:"block",position:"absolute",bottom:"-15px",left:"0",right:"0",margin:"0 auto",clipPath:"path('M 0 0 L 20 0 L 10 15 Z')",width:"20px",height:"15px",backgroundColor:e.palette.background.paper}})),cs=G(Dr)(()=>({"&::before":{top:"-15px",bottom:"unset",clipPath:"path('M 0 15 L 20 15 L 10 0 Z')"}})),dr=({children:e,open:t,onClose:r,anchorPosition:n,above:s})=>{let c=cs;s&&(c=Dr);let i="bottom";s&&(i="top");let a="top";s&&(a="bottom");let l="28px";return s&&(l="-28px"),o.jsx(Kr,{anchorReference:"anchorPosition",anchorPosition:n,open:t,onClose:r,anchorOrigin:{vertical:i,horizontal:"center"},transformOrigin:{vertical:a,horizontal:"center"},PaperProps:{style:{boxShadow:"none",overflow:"visible",marginBlockStart:l}},children:o.jsx(c,{children:e})})},us=G(Ot)(()=>({"& .MuiTableRow-root:last-of-type .MuiTableCell-root":{borderBottom:"none"}})),ot=({value:e})=>o.jsx(Z,{children:o.jsx("ul",{style:{padding:0,margin:0,listStyleType:"none"},children:Array.isArray(e)?e.map((t,r)=>o.jsx("li",{children:t},r)):o.jsx("li",{children:e})})}),ds=({nodeData:e})=>{const{name:t,id:r,categories:n,count:s}=e;return o.jsx(Fe,{style:{maxHeight:500,overflow:"auto"},children:o.jsx(zt,{size:"small","aria-label":"node attributes table",children:o.jsxs(us,{children:[!!t&&o.jsxs(ce,{style:{verticalAlign:"top"},children:[o.jsx(Z,{children:"Name"}),o.jsx(ot,{value:t})]}),!!r&&o.jsxs(ce,{style:{verticalAlign:"top"},children:[o.jsx(Z,{children:"ID"}),o.jsx(ot,{value:r})]}),!!n&&o.jsxs(ce,{style:{verticalAlign:"top"},children:[o.jsx(Z,{children:"Categories"}),o.jsx(ot,{value:n})]}),!!s&&o.jsxs(ce,{style:{verticalAlign:"top"},children:[o.jsx(Z,{children:"Count"}),o.jsx(ot,{value:s})]})]})})})},Le=40;function ps({answerStore:e}){const t=h.useRef(null),r=h.useRef(null),n=h.useRef(0),s=h.useRef(0),c=h.useRef(null),i=h.useRef(null),a=h.useRef(null),{colorMap:l,predicates:u}=h.useContext(gt),[x,T]=h.useState(e.numQgNodes),d=Wr(x,500),[f,M]=h.useState({x:0,y:0}),[A,L]=h.useState(null),[O,k]=h.useState({}),y=(u||[]).filter(g=>g&&g.symmetric).map(g=>g.predicate);h.useEffect(()=>{if(!t.current)return;r.current=ne(t.current);const{width:g,height:R}=r.current.node().getBoundingClientRect();n.current=g,s.current=R,r.current.attr("width",n.current).attr("height",s.current).attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",[0,0,n.current,s.current]),r.current.select("defs").empty()&&r.current.append("defs").append("marker").attr("id","arrow").attr("viewBox",[0,0,20,13]).attr("refX",20).attr("refY",6.5).attr("markerWidth",6.5).attr("markerHeight",25).attr("orient","auto-start-reverse").append("path").attr("d",fr()([[0,0],[0,13],[25,6.5]])).attr("fill","#999"),r.current.select("#nodeContainer").empty()&&(r.current.append("g").attr("id","nodeContainer"),c.current=r.current.select("#nodeContainer").selectAll("g")),r.current.select("#edgeContainer").empty()&&(r.current.append("g").attr("id","edgeContainer"),i.current=r.current.select("#edgeContainer").selectAll("g"))},[]);function b(){!c.current||!i.current||(c.current.attr("transform",g=>{let R=Le;return g.fx!==null&&g.fx!==void 0&&(R*=.5),g.x=se.getBoundedValue(Number(g.x),Number(n.current)-R,R),g.y=se.getBoundedValue(Number(g.y),Number(s.current)-R,R),`translate(${g.x}, ${g.y})`}),i.current.select(".result_edge").attr("d",g=>{const{x1:R,y1:q,qx:V,qy:P,x2:j,y2:W}=se.getCurvedEdgePos(Number(g.source.x),Number(g.source.y),Number(g.target.x),Number(g.target.y),Number(g.numEdges),Number(g.index),Le);return`M${R},${q}Q${V},${P} ${j},${W}`}),i.current.select(".result_edge_transparent").attr("d",g=>{const{x1:R,y1:q,qx:V,qy:P,x2:j,y2:W}=se.getCurvedEdgePos(Number(g.source.x),Number(g.source.y),Number(g.target.x),Number(g.target.y),Number(g.numEdges),Number(g.index),Le),F=R>j?`${j},${W}`:`${R},${q}`,z=R>j?`${R},${q}`:`${j},${W}`;return`M${F}Q${V},${P} ${z}`}))}h.useEffect(()=>{a.current=gr().force("collide",mr().radius(Le*2)).force("link",xr().id(g=>g.id).distance(175).strength(0)).on("tick",b)},[]);function v(){if(!r.current||!a.current)return;const{width:g,height:R}=r.current.node().getBoundingClientRect();n.current=g,s.current=R,r.current.attr("width",n.current).attr("height",s.current).attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",[0,0,n.current,s.current]),a.current.force("center",hr(n.current/2,s.current/2).strength(.5)).force("forceY",Nr(s.current/2).strength(.2));const q=new Map((c.current?c.current.data():[]).map(m=>[m.id,{x:m.x,y:m.y}])),P=Object.values(e.selectedResult.nodes).sort((m,E)=>E.score-m.score).slice(0,e.showNodePruneSlider?Number(d):void 0),j=P.map(m=>Object.assign(q.get(m.id)||{x:Math.random()*n.current,y:Math.random()*s.current},m)),W=P.map(m=>m.id),z=Object.keys(e.selectedResult.edges).filter(m=>{const E=e.selectedResult.edges[m];return W.includes(E.source)&&W.includes(E.target)}).map(m=>{var E,C;return{...e.selectedResult.edges[m],attributes:(E=e.resultJSON.knowledge_graph.edges[m])==null?void 0:E.attributes,sources:(C=e.resultJSON.knowledge_graph.edges[m])==null?void 0:C.sources}}).map(m=>({...m}));a.current.nodes(j),a.current.force("link").links(z),c.current=c.current.data(j,m=>m.id).join(m=>m.append("g").attr("class","result_node").call(br.dragNode(a.current)).call(E=>E.append("circle").attr("r",Le).attr("fill",C=>l?l(C.categories)[1]:"#ccc").call(C=>C.append("title").text(X=>X.name)).style("transition","stroke-width 200ms ease-in-out, stroke 200ms ease-in-out, filter 200ms ease-in-out").style("cursor","pointer").on("mouseover",function(){ne(this).attr("stroke","#239cff").style("filter","brightness(1.1)").attr("stroke-width",3)}).on("mouseout",function(){ne(this).attr("stroke","none").style("filter","initial").attr("stroke-width",0)}).on("click",function(){_(ne(this).datum())})).call(E=>E.append("text").attr("class","result_node_label").style("pointer-events","none").attr("text-anchor","middle").style("font-weight",600).attr("alignment-baseline","middle").text(C=>C.name).each(se.fitTextIntoCircle)),m=>m,m=>m.transition().ease(kt).duration(1e3).attr("transform",E=>`translate(${E.x},-40)`).call(E=>E.select("circle").attr("fill","red")).remove());const S=yr.addEdgeCurveProperties(z);i.current=i.current.data(S,m=>m.id).join(m=>m.append("g").call(E=>E.append("path").attr("stroke","transparent").attr("fill","none").attr("stroke-width",10).attr("class","result_edge_transparent").attr("id",C=>`result_explorer_edge${C.id}`).call(()=>E.append("text").attr("stroke","none").attr("class","edgeText").attr("pointer-events","none").style("text-anchor","middle").attr("dy",C=>-(C.strokeWidth||0)).append("textPath").attr("pointer-events","none").attr("xlink:href",C=>`#result_explorer_edge${C.id}`).attr("startOffset","50%").text(C=>ge.displayPredicate(C.predicate))).call(C=>C.append("title").text(X=>ge.displayPredicate(X.predicate)))).call(E=>E.append("path").attr("stroke","inherit").attr("fill","none").attr("stroke-width",C=>C.strokeWidth).attr("class","result_edge").attr("marker-end",C=>se.shouldShowArrow(C,y)?"url(#arrow)":"")).attr("fill","black").attr("stroke","#999").style("transition","stroke 100ms ease-in-out, fill 100ms ease-in-out").style("cursor","pointer").on("mouseover",function(){ne(this).attr("fill","#239cff").attr("stroke","#239cff")}).on("mouseout",function(){ne(this).attr("fill","black").attr("stroke","#999")}).on("click",function(E){D(E,ne(this).datum())}),m=>m.call(E=>E.select("title").text(C=>ge.displayPredicate(C.predicate))).call(E=>E.select("text").select("textPath").text(C=>ge.displayPredicate(C.predicate))),m=>m.remove()),a.current.alpha(1).restart()}function $(){const g=ne("#resultExplorer"),R=50;if(e.selectedRowId!==""){const q=parseInt(g.style("width"),10),P=1e3*((R-q%(R+1))/R);g.transition().ease(kt).duration(P).style("width",`${R}%`).style("margin-left","10px").on("end",v).style("overflow-y","unset")}else g.style("overflow-y","auto").transition().ease(kt).duration(1e3).style("width","0%"),ne(t.current).attr("width","0")}const D=(g,R)=>{M({x:g.clientX,y:g.clientY}),k(R),L("edge")},_=g=>{if(!t.current)return;const{top:R,left:q}=t.current.getBoundingClientRect();M({x:q+(g.x??0),y:R+(g.y??0)}),k({name:g.name,id:g.id,categories:g.categories}),L("node")};return h.useEffect(()=>{$()},[e.selectedResult,e.selectedRowId,d,l]),o.jsxs(Te,{id:"resultExplorer",elevation:3,children:[o.jsx("h5",{className:"cardLabel",children:"Answer Explorer"}),!!e.showNodePruneSlider&&o.jsx(Fe,{width:200,id:"nodeNumSlider",children:o.jsx(fo,{value:x,valueLabelDisplay:"auto",min:e.numQgNodes,max:e.selectedResult.nodes?Object.keys(e.selectedResult.nodes).length:e.numQgNodes,onChange:(g,R)=>T(R)})}),o.jsx("svg",{ref:t,style:{flex:1,width:"100%"}}),e.metaData&&o.jsx(os,{metaData:e.metaData,result:e.resultJSON}),o.jsx(dr,{open:A==="edge",onClose:()=>L(null),anchorPosition:{top:f.y,left:f.x},above:!0,children:A==="edge"&&o.jsx(ls,{attributes:O.attributes,sources:O.sources})}),o.jsx(dr,{open:A==="node",onClose:()=>L(null),anchorPosition:{top:f.y,left:f.x},above:!0,children:A==="node"&&o.jsx(ds,{nodeData:O})})]})}function pr(e){const t=[];for(let r=0;r<e;r+=1)t.push("");return t}function fs({numRows:e,numCells:t,text:r}){const n=pr(e),s=pr(t);return o.jsxs(o.Fragment,{children:[n.map((c,i)=>o.jsx(ce,{children:s.map((a,l)=>o.jsx(Z,{className:"emptyCell",children:" "},`empty-cell-${l}`))},`empty-row-${i}`)),o.jsx(ce,{id:"emptyTableRowsText",children:o.jsx(Z,{children:r})})]})}function gs({answerStore:e}){const[t,r]=st.useState([{id:"score",desc:!0}]),[n,s]=st.useState([]),[c,i]=st.useState({pageIndex:0,pageSize:15}),a=h.useMemo(()=>e.message.results,[e.message]),l=h.useMemo(()=>e.tableHeaders.map(d=>{const f={id:d.id||(typeof d.accessor=="string"?d.accessor:d.id),header:d.Header,cell:d.Cell?M=>d.Cell({value:M.getValue()}):void 0,enableSorting:!d.disableSortBy,enableColumnFilter:!d.disableFilters,meta:{color:d.color,width:d.width}};return typeof d.accessor=="function"?f.accessorFn=d.accessor:typeof d.accessor=="string"&&(f.accessorKey=d.accessor),d.filter==="equals"&&(f.filterFn="equals"),f}),[e.tableHeaders]),u=gn({data:a,columns:l,getCoreRowModel:yn(),getFilteredRowModel:bn(),getSortedRowModel:xn(),getPaginationRowModel:mn(),state:{sorting:t,columnFilters:n,pagination:c},onSortingChange:r,onColumnFiltersChange:s,onPaginationChange:i,initialState:{pagination:{pageIndex:0,pageSize:15},sorting:[{id:"score",desc:!0}]}}),x=(d,f)=>{u.setPageIndex(f)},T=d=>{const f=Number(d.target.value);u.setPageSize(f)};return o.jsx(o.Fragment,{children:o.jsxs("div",{id:"resultsContainer",children:[o.jsxs(Te,{id:"resultsTable",elevation:3,children:[o.jsx(xo,{children:o.jsxs(zt,{children:[o.jsx(Pr,{children:u.getHeaderGroups().map(d=>o.jsx(ce,{children:d.headers.map(f=>{var M,A;return o.jsx(Z,{className:"resultsTableHeader",style:{backgroundColor:(M=f.column.columnDef.meta)==null?void 0:M.color,cursor:f.column.getCanSort()?"pointer":"",width:(A=f.column.columnDef.meta)==null?void 0:A.width},children:f.isPlaceholder?null:o.jsxs(o.Fragment,{children:[f.column.getCanSort()?o.jsx(So,{active:!!f.column.getIsSorted(),direction:f.column.getIsSorted()==="desc"?"desc":"asc",onClick:f.column.getToggleSortingHandler(),children:Ct(f.column.columnDef.header,f.getContext())}):o.jsx(o.Fragment,{children:Ct(f.column.columnDef.header,f.getContext())}),o.jsx("div",{children:f.column.getCanFilter()&&o.jsxs("select",{value:f.column.getFilterValue()||"",onChange:L=>{f.column.setFilterValue(L.target.value||void 0)},className:"resultsFilterSelect",children:[o.jsx("option",{value:"",children:"All"}),Array.from(new Set(u.getPreFilteredRowModel().rows.map(L=>{const O=L.getValue(f.column.id);return O?String(O):null}).filter(Boolean))).map((L,O)=>o.jsx("option",{value:L??"",children:L??""},O))]})})]})},f.id)})},d.id))}),o.jsx(Ot,{style:{position:"relative"},children:u.getRowModel().rows.length>0?o.jsx(o.Fragment,{children:u.getRowModel().rows.map(d=>o.jsx(ce,{hover:!0,selected:e.selectedRowId===d.id,onClick:()=>e.selectRow(d.original,d.id),role:"button",children:d.getVisibleCells().map(f=>o.jsx(Z,{children:Ct(f.column.columnDef.cell,f.getContext())},f.id))},d.id))}):o.jsx(fs,{numRows:15,numCells:l.length,text:"No Results"})})]})}),o.jsx(hn,{rowsPerPageOptions:[5,10,15,50,100],count:a.length,rowsPerPage:u.getState().pagination.pageSize,page:u.getState().pagination.pageIndex,onPageChange:x,onRowsPerPageChange:T,component:"div"})]}),o.jsx(ps,{answerStore:e})]})})}function Ls({answer_id:e}){const{displayAlert:t}=vn(),r=Lo(),n=_r(),{displayState:s,updateDisplayState:c}=Do(),[i,a,l]=[!1,!1,()=>Promise.resolve("")],u=Yr(a,"Loading Message..."),[x,T]=h.useState(!1);function d(k){if(k&&k.status&&k.status==="error"){u.setFailure(k.message);return}let y;try{y=JSON.parse(k)}catch(v){console.error("Failed to parse answer response:",v),u.setFailure("Invalid answer JSON");return}if(y.status==="error"){u.setFailure(`Error during answer processing: ${y.message}`);return}const b=Bt.validateMessage(y);if(b.length){u.setFailure(`Found errors while parsing message: ${b.join(", ")}`);return}try{y.message.query_graph=ut.toCurrentTRAPI(y.message.query_graph);try{r.initialize(y.message,c),u.setSuccess()}catch(v){t("error",`Failed to initialize message. Please submit an issue: ${v}`)}}catch(v){console.error("Failed to parse query graph:",v),t("error","Failed to parse this query graph. Please make sure it is TRAPI compliant.")}}async function f(){let k;if(i)try{k=await l()}catch(b){t("error",`Failed to authenticate user: ${b}`)}const y=await fe.cache.getAnswerData(e,k);d(y)}async function M(){let k;if(i)try{k=await l()}catch(b){t("error",`Failed to authenticate user: ${b}`)}const y=await fe.cache.getAnswer(e??null,k??null);if(y.status==="error"){u.setFailure(y.message);return}T(y.owned)}h.useEffect(()=>{a||(u.setLoading("Loading Message..."),e?(Hr("quick_message"),M(),f()):Jr("quick_message").then(k=>{k?d(k):(r.reset(),u.setSuccess())}).catch(k=>{r.reset(),t("error",`Failed to load answer. Please try refreshing the page. Error: ${k}`),u.setSuccess()}))},[e,a]);function A(k){Array.from(k.target.files??[]).forEach(b=>{const v=new window.FileReader;v.onloadstart=()=>u.setLoading("Loading Message..."),v.onload=$=>{if(!$.target)return;const D=$.target.result;let _={};try{_=JSON.parse(typeof D=="string"?D:"")}catch(R){console.error("Failed to parse uploaded file:",R),t("error","Failed to read this message. Are you sure this is valid JSON?")}const g=Bt.validateMessage(_);if(g.length)u.setFailure(g.join(", "));else{try{_.message.query_graph=ut.toCurrentTRAPI(_.message.query_graph);try{Gr("quick_message",JSON.stringify(_)),r.initialize(_.message,c),e&&n({to:"/answer"})}catch(R){t("error",`Failed to initialize message. Please submit an issue: ${R}`),r.reset()}}catch(R){console.error("Failed to parse query graph:",R),t("error","Failed to parse this query graph. Please make sure it is TRAPI compliant.")}u.setSuccess()}},v.onerror=()=>{t("error","Sorry but there was a problem uploading the file. The file may be invalid JSON."),u.setSuccess()},v.readAsText(b)}),k.target.value=""}async function L(){let k;if(i)try{k=await l()}catch(v){t("error",`Failed to authenticate user: ${v}`)}else return t("warning","You need to be signed in to save an answer.");let y=await fe.cache.createAnswer(jo,k??null);if(y.status==="error"){t("error",`Failed to create answer: ${y.message}`);return}const b=y.id;return y=await fe.cache.setAnswerData(b,{message:r.message},k),y.status==="error"?t("error",`Failed to save answer: ${y.message}`):t("success","Your answer has been saved!")}async function O(){let k;if(i)try{k=await l()}catch(D){t("error",`Failed to authenticate user: ${D}`)}else return t("warning","You need to be signed in to delete an answer.");let y=await fe.cache.getAnswer(e??null,k??null);if(y.status==="error"){t("error",`Failed to fetch answer: ${y.message}`);return}const b=y.parent;if(y=await fe.cache.deleteAnswer(e??null,k??null),y.status==="error"){t("error",`Failed to delete answer: ${y.message}`);return}n({to:"/answer"});let v="success",$="Your answer has been deleted!";return b&&(y=await fe.cache.getAnswers(b,k??null),y.status==="error"?(v="error",$+=` However, failed to get sibling answers: ${y.message}`):y.length||(y=await fe.cache.getQuestion(b,k??null),y.status==="error"?(v="error",$+=` However, failed to get associated question data: ${y.message}`):(y.metadata.hasAnswers=!1,y=await fe.cache.updateQuestion(y,k??null),y.status==="error"&&(v="error",$+=" However, failed to update associated question to no answers.")))),t(v,$)}return o.jsxs(o.Fragment,{children:[o.jsx(zo,{displayState:s,updateDisplayState:c,onUpload:A,message:r.message,saveAnswer:L,deleteAnswer:O,owned:x}),o.jsxs("div",{id:"answerContentContainer",children:[o.jsx(u.Display,{}),u.displayPage&&o.jsx(o.Fragment,{children:Object.keys(r.message).length?o.jsxs(o.Fragment,{children:[s.qg.show&&r.message.query_graph&&o.jsx(_o,{query_graph:r.message.query_graph}),s.kgFull.show&&r.message.knowledge_graph&&o.jsx(Bo,{message:r.message}),s.results.show&&o.jsx(gs,{answerStore:r})]}):o.jsx("div",{id:"answerPageSplashMessage",children:o.jsx("h2",{children:"Please upload an answer"})})})]})]})}export{Ls as A};
