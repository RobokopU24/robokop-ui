import{r as e,u as d,j as v}from"./main-Bxfe4Qal.js";import{u as f,a as x,r as k}from"./AlertProvider-CS83QDva.js";const l=e.createContext(null),T=({children:t})=>{const c=d(),{displayAlert:n}=f(),[i,o]=e.useState(null),[g,r]=e.useState(!0);e.useEffect(()=>{(async()=>{const a=localStorage.getItem("authToken");if(!a){r(!1);return}try{const u=await x.post(k.authRoutes.validateToken,{token:a});o(u.data.user)}catch(u){console.log(u),localStorage.removeItem("authToken")}finally{r(!1)}})()},[]);const h=(s,a)=>{o(s),localStorage.setItem("authToken",a),n("success","You have successfully logged in.")},m=async()=>{o(null),localStorage.removeItem("authToken"),await new Promise(s=>setTimeout(s,0)),n("success","You have successfully logged out."),c({to:"/"})};return v.jsx(l.Provider,{value:{user:i,loading:g,setUser:o,login:h,logout:m},children:t})},y=()=>{const t=e.useContext(l);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};export{T as A,y as u};
