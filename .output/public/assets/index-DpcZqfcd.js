import{c as w,u as N,R as a,r as d,j as e,N as D}from"./main-Bxfe4Qal.js";import{u as T}from"./AuthContext-6RiyJAM4.js";import{u as C,a as h,r as f}from"./AlertProvider-CS83QDva.js";import{D as R,a as $,b}from"./DialogTitle-BsB0Df6C.js";import{I}from"./Input-DrgcAPlg.js";import{B as F}from"./Button-CpGhMJw8.js";import"./CircularProgress-B8CBKe07.js";import"./createSimplePaletteValueFilter-BgnxeUzB.js";import"./isFocusVisible-B8k4qzLc.js";import"./IconButton-D-WOROUy.js";import"./Paper-BphQmbS1.js";import"./Modal-CENjY7I_.js";import"./Typography-S0UZMlvX.js";import"./isHostComponent-D3YBfmz0.js";function P(){const i=w({from:"/_appLayout/activate-user/"}),{user:x}=T(),c=N(),{displayAlert:o}=C(),[n,v]=a.useState(""),[l,g]=a.useState(""),[r,j]=a.useState(""),[y,u]=a.useState("");d.useEffect(()=>{h.get(`${f.authRoutes.activateUserTokenHandler}/?token=${i.token}`).then(t=>{g(t.data.email),j(t.data.exp)}).catch(t=>{console.error("Error fetching activation data:",t),o("error","Invalid or expired activation link. Please try again."),c({to:"/question-builder"})})},[]);const m=t=>{const A=new Date(Number(t)*1e3),E=new Date,s=A.getTime()-E.getTime();if(s<=0)return"Expired";const S=Math.floor(s/1e3/60%60),p=Math.floor(s/1e3%60);return`${S}:${p<10?"0":""}${p} mins`};if(d.useEffect(()=>{if(!r)return;const t=setInterval(()=>{u(m(r))},1e3);return u(m(r)),()=>clearInterval(t)},[r]),x)return e.jsx(D,{to:"/",replace:!0});const k=()=>{h.post(f.authRoutes.activateNewUser,{email:l.trim(),name:n.trim()}).then(t=>{o("success","Account activated successfully!."),c({to:`/oauth-callback?token=${t.data.token}`})}).catch(t=>{console.error("Error activating account:",t),o("error","Failed to activate account. Please try again.")})};return e.jsxs(R,{open:!0,maxWidth:"sm",fullWidth:!0,children:[e.jsx($,{children:"Activate Your Account"}),e.jsxs(b,{children:[e.jsxs("p",{children:["Hello ",e.jsxs("strong",{children:[l,"!"]})]}),e.jsxs("p",{children:["You're almost done activating your account. Please enter your full name and click"," ",e.jsx("strong",{children:"Activate"}),"."]}),e.jsxs("p",{style:{fontSize:"1rem",color:"red"},children:["Your link will expire in ",y,"."]}),e.jsx(I,{placeholder:"Full Name",fullWidth:!0,required:!0,value:n,onChange:t=>v(t.target.value)}),e.jsx(F,{variant:"contained",color:"primary",onClick:k,disabled:!n,style:{marginTop:"16px"},children:"Activate"})]})]})}const Q=function(){return e.jsx(P,{})};export{Q as component};
